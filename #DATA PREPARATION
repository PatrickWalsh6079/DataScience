'''
This program grabs all files that start with "BIO", "SYM", or "NEG" prefix and copies them to folders
labeled "Biofilm", "Symplast", and "Negative" respectively. It then attaches a randomly assigned 4 letter
prefix to each file so that they are assigned to the folder in random order.
Next, the program moves 400 Biofilm and 400 Symplast files to 8 separate subfolders, each
subfolder containing 100 images of either Biofilm or Symplasts. It also attaches labels to these
images indicating which training iteration they belong to. It also zips these subfolders.
It also moves 200 files from the Biofilm (80), Symplast (80), and Negative (40) folders into a Testing
folder. Finally, the user has the ability to delete all training data from Biofilm and Symplast folders,
as well as all subfolders and testing folder with a single call.
'''

# ALL BIOFILM
#############################################################
# moves all biofilm images into Biofilm folder with randomly
# attached prefix.
#############################################################

import os, shutil, glob, random, string

# shows where files are coming from
source = r'C:\Users\pwalsh\Desktop\TEMPORARY'
# shows where biofilm images go
dest = r'C:\Users\pwalsh\Desktop\Classifier Testing\Biofilm'
path = os.listdir(source)

# moves all biofilm images to appropriate folder
for f in glob.glob(source+'\\BIO*'):
    shutil.copy(f, dest)

path = r'C:\Users\pwalsh\Desktop\Classifier Testing\Biofilm'

# attaches random prefix to biofilm images
for f in os.listdir(dest):
    os.rename(os.path.join(path,f), os.path.join(path,random.choice(string.ascii_lowercase)
    +random.choice(string.ascii_lowercase)+random.choice(string.ascii_lowercase)+
    random.choice(string.ascii_lowercase)+' '+f))


# ALL SYMPLASTS
#############################################################
# moves all symplast images into Symplast folder with randomly
# attached prefix.
#############################################################

import os, shutil, glob, random, string

# shows where files are coming from
source = r'C:\Users\pwalsh\Desktop\TEMPORARY'
# reassigns dest variable to have symplast images go to other folder    
dest = r'C:\Users\pwalsh\Desktop\Classifier Testing\Symplast'

# moves all symplast images to appropriate folder
for f in glob.glob(source+'\\SYM*'):
    shutil.copy(f, dest)

path = r'C:\Users\pwalsh\Desktop\Classifier Testing\Symplast'

# attaches random prefix to symplast images
for f in os.listdir(dest):
    os.rename(os.path.join(path,f), os.path.join(path,random.choice(string.ascii_lowercase)
    +random.choice(string.ascii_lowercase)+random.choice(string.ascii_lowercase)+
    random.choice(string.ascii_lowercase)+' '+f))

# ALL NEGATIVE
##############################################################
# moves all negative images into Negative folder with randomly
# attached prefix.
##############################################################

import os, shutil, glob, random, string

# shows where files are coming from
source = r'C:\Users\pwalsh\Desktop\TEMPORARY'
# reassigns dest variable to have negative images go to other folder    
dest = r'C:\Users\pwalsh\Desktop\Classifier Testing\Negative'

# moves all negative images to appropriate folder
for f in glob.glob(source+'\\NEG*'):
    shutil.copy(f, dest)

path = r'C:\Users\pwalsh\Desktop\Classifier Testing\Negative'

# attaches random prefix to negative images
for f in os.listdir(dest):
    os.rename(os.path.join(path,f), os.path.join(path,random.choice(string.ascii_lowercase)
    +random.choice(string.ascii_lowercase)+random.choice(string.ascii_lowercase)+
    random.choice(string.ascii_lowercase)+' '+f))

# PREPARING TRAINING AND TESTING DATA
#####################################################################
# moves 800 training images from biofilm and symplasts folders into 
# dataset subfolders of 100 images each then zips the subfolders. 
# Also moves 200 images for testing into Testing folder. the amounts 
# are 80 biofilm, 80 symplast, and 40 negative images.
#####################################################################

import os, shutil, glob, random, string, zipfile

bio = r'C:\Users\pwalsh\Desktop\Classifier Testing\Biofilm'
sym = r'C:\Users\pwalsh\Desktop\Classifier Testing\Symplast'
neg = r'C:\Users\pwalsh\Desktop\Classifier Testing\Negative'
final_dest = r'C:\Users\pwalsh\Desktop\Classifier Testing\Datasets'
test = r'C:\Users\pwalsh\Desktop\Classifier Testing\Testing'
counter = 0


##################################################
# moves biofilm images into respective subfolders
#################################################
path = os.listdir(bio)


zipped = 'BIO Dataset 1'
dataset = r'C:\Users\pwalsh\Desktop\Classifier Testing\Datasets\BIO Dataset 1'
for f in glob.glob(bio+'\\*'):
    shutil.move(f, dataset)
    counter += 1
    if counter > 99:
        break

# attaches training iteration label
for f in os.listdir(dataset):
    os.rename(os.path.join(dataset,f), os.path.join(dataset,'SET 1'+' '+f))

# zips folder
training_zip = zipfile.ZipFile(final_dest+'\\'+zipped+'.zip', 'w') 
for folder, subfolders, files in os.walk(final_dest+'\\'+zipped):
    for file in files:
        if file.endswith('.jpg'):
            training_zip.write(os.path.join(folder, file), os.path.relpath(os.path.join(folder,file), 'C:\\Stories\\Fantasy'), compress_type = zipfile.ZIP_DEFLATED)

training_zip.close()

# reset counter to 0
counter = 0

zipped = 'BIO Dataset 2'
dataset = r'C:\Users\pwalsh\Desktop\Classifier Testing\Datasets\BIO Dataset 2'
for f in glob.glob(bio+'\\*'):
    shutil.move(f, final_dest+'\\'+zipped)
    counter += 1
    if counter > 99:
        break

# attaches training iteration label
for f in os.listdir(dataset):
    os.rename(os.path.join(dataset,f), os.path.join(dataset,'SET 2'+' '+f))

# zips folder
training_zip = zipfile.ZipFile(final_dest+'\\'+zipped+'.zip', 'w') 
for folder, subfolders, files in os.walk(final_dest+'\\'+zipped):
    for file in files:
        if file.endswith('.jpg'):
            training_zip.write(os.path.join(folder, file), os.path.relpath(os.path.join(folder,file), 'C:\\Stories\\Fantasy'), compress_type = zipfile.ZIP_DEFLATED)

training_zip.close()

# reset counter to 0
counter = 0

zipped = 'BIO Dataset 3'
dataset = r'C:\Users\pwalsh\Desktop\Classifier Testing\Datasets\BIO Dataset 3'
for f in glob.glob(bio+'\\*'):
    shutil.move(f, final_dest+'\\'+zipped)
    counter += 1
    if counter > 99:
        break

# attaches training iteration label
for f in os.listdir(dataset):
    os.rename(os.path.join(dataset,f), os.path.join(dataset,'SET 3'+' '+f))

# zips folder
training_zip = zipfile.ZipFile(final_dest+'\\'+zipped+'.zip', 'w') 
for folder, subfolders, files in os.walk(final_dest+'\\'+zipped):
    for file in files:
        if file.endswith('.jpg'):
            training_zip.write(os.path.join(folder, file), os.path.relpath(os.path.join(folder,file), 'C:\\Stories\\Fantasy'), compress_type = zipfile.ZIP_DEFLATED)

training_zip.close()

# reset counter to 0
counter = 0
        
zipped = 'BIO Dataset 4'
dataset = r'C:\Users\pwalsh\Desktop\Classifier Testing\Datasets\BIO Dataset 4'
for f in glob.glob(bio+'\\*'):
    shutil.move(f, final_dest+'\\'+zipped)
    counter += 1
    if counter > 99:
        break

# attaches training iteration label
for f in os.listdir(dataset):
    os.rename(os.path.join(dataset,f), os.path.join(dataset,'SET 4'+' '+f))

# zips folder
training_zip = zipfile.ZipFile(final_dest+'\\'+zipped+'.zip', 'w') 
for folder, subfolders, files in os.walk(final_dest+'\\'+zipped):
    for file in files:
        if file.endswith('.jpg'):
            training_zip.write(os.path.join(folder, file), os.path.relpath(os.path.join(folder,file), 'C:\\Stories\\Fantasy'), compress_type = zipfile.ZIP_DEFLATED)

training_zip.close()

# reset counter to 0
counter = 0


###################################################
# moves symplast images into respective subfolders
###################################################
path = os.listdir(sym)


zipped = 'SYM Dataset 1'
dataset = r'C:\Users\pwalsh\Desktop\Classifier Testing\Datasets\SYM Dataset 1'
for f in glob.glob(sym+'\\*'):
    shutil.move(f, final_dest+'\\'+zipped)
    counter += 1
    if counter > 99:
        break

# attaches training iteration label
for f in os.listdir(dataset):
    os.rename(os.path.join(dataset,f), os.path.join(dataset,'SET 1'+' '+f))

# zips folder
training_zip = zipfile.ZipFile(final_dest+'\\'+zipped+'.zip', 'w') 
for folder, subfolders, files in os.walk(final_dest+'\\'+zipped):
    for file in files:
        if file.endswith('.jpg'):
            training_zip.write(os.path.join(folder, file), os.path.relpath(os.path.join(folder,file), 'C:\\Stories\\Fantasy'), compress_type = zipfile.ZIP_DEFLATED)

training_zip.close()

# reset counter to 0
counter = 0

zipped = 'SYM Dataset 2'
dataset = r'C:\Users\pwalsh\Desktop\Classifier Testing\Datasets\SYM Dataset 2'
for f in glob.glob(sym+'\\*'):
    shutil.move(f, final_dest+'\\'+zipped)
    counter += 1
    if counter > 99:
        break

# attaches training iteration label
for f in os.listdir(dataset):
    os.rename(os.path.join(dataset,f), os.path.join(dataset,'SET 2'+' '+f))

# zips folder
training_zip = zipfile.ZipFile(final_dest+'\\'+zipped+'.zip', 'w') 
for folder, subfolders, files in os.walk(final_dest+'\\'+zipped):
    for file in files:
        if file.endswith('.jpg'):
            training_zip.write(os.path.join(folder, file), os.path.relpath(os.path.join(folder,file), 'C:\\Stories\\Fantasy'), compress_type = zipfile.ZIP_DEFLATED)

training_zip.close()

# reset counter to 0
counter = 0

zipped = 'SYM Dataset 3'
dataset = r'C:\Users\pwalsh\Desktop\Classifier Testing\Datasets\SYM Dataset 3'
for f in glob.glob(sym+'\\*'):
    shutil.move(f, final_dest+'\\'+zipped)
    counter += 1
    if counter > 99:
        break

# attaches training iteration label
for f in os.listdir(dataset):
    os.rename(os.path.join(dataset,f), os.path.join(dataset,'SET 3'+' '+f))

# zips folder
training_zip = zipfile.ZipFile(final_dest+'\\'+zipped+'.zip', 'w') 
for folder, subfolders, files in os.walk(final_dest+'\\'+zipped):
    for file in files:
        if file.endswith('.jpg'):
            training_zip.write(os.path.join(folder, file), os.path.relpath(os.path.join(folder,file), 'C:\\Stories\\Fantasy'), compress_type = zipfile.ZIP_DEFLATED)

training_zip.close()

# reset counter to 0
counter = 0
        
zipped = 'SYM Dataset 4'
dataset = r'C:\Users\pwalsh\Desktop\Classifier Testing\Datasets\SYM Dataset 4'
for f in glob.glob(sym+'\\*'):
    shutil.move(f, final_dest+'\\'+zipped)
    counter += 1
    if counter > 99:
        break

# attaches training iteration label
for f in os.listdir(dataset):
    os.rename(os.path.join(dataset,f), os.path.join(dataset,'SET 4'+' '+f))

# zips folder
training_zip = zipfile.ZipFile(final_dest+'\\'+zipped+'.zip', 'w') 
for folder, subfolders, files in os.walk(final_dest+'\\'+zipped):
    for file in files:
        if file.endswith('.jpg'):
            training_zip.write(os.path.join(folder, file), os.path.relpath(os.path.join(folder,file), 'C:\\Stories\\Fantasy'), compress_type = zipfile.ZIP_DEFLATED)

training_zip.close()

# reset counter to 0
counter = 0


##################################
# moves files into testing folder
#################################
path = os.listdir(bio)


for f in glob.glob(bio+'\\*'):
    shutil.move(f, test)
    counter += 1
    if counter > 79:
        break

# reset counter to 0
counter = 0

for f in glob.glob(sym+'\\*'):
    shutil.move(f, test)
    counter += 1
    if counter > 79:
        break

# reset counter to 0
counter = 0

for f in glob.glob(neg+'\\*'):
    shutil.move(f, test)
    counter += 1
    if counter > 39:
        break

# DATA RESET
###########################################################################
# removes all training images from Biofilm, Symplast, and Negative as well 
# as all subfolders and Testing folder. deletes zipped folders.
###########################################################################

#########################################
# removes all images from biofilm folder
#########################################
folder = r'C:\Users\pwalsh\Desktop\Classifier Testing\Biofilm'
for f in os.listdir(folder):
    f = os.path.join(folder, f)
    if os.path.isfile(f):
        os.unlink(f)

##########################################
# removes all images from symplast folder
##########################################
folder = r'C:\Users\pwalsh\Desktop\Classifier Testing\Symplast'
for f in os.listdir(folder):
    f = os.path.join(folder, f)
    if os.path.isfile(f):
        os.unlink(f)

##########################################
# removes all images from negative folder
##########################################
folder = r'C:\Users\pwalsh\Desktop\Classifier Testing\Negative'
for f in os.listdir(folder):
    f = os.path.join(folder, f)
    if os.path.isfile(f):
        os.unlink(f)

        
#####################################################################      
# removes all images from biofilm subfolders, deletes zipped folders
#####################################################################
folder = r'C:\Users\pwalsh\Desktop\Classifier Testing\Datasets\BIO Dataset 1'
for f in os.listdir(folder):
    f = os.path.join(folder, f)
    if os.path.isfile(f):
        os.unlink(f)
os.remove(folder+'.zip')

folder = r'C:\Users\pwalsh\Desktop\Classifier Testing\Datasets\BIO Dataset 2'
for f in os.listdir(folder):
    f = os.path.join(folder, f)
    if os.path.isfile(f):
        os.unlink(f)
os.remove(folder+'.zip')

folder = r'C:\Users\pwalsh\Desktop\Classifier Testing\Datasets\BIO Dataset 3'
for f in os.listdir(folder):
    f = os.path.join(folder, f)
    if os.path.isfile(f):
        os.unlink(f)
os.remove(folder+'.zip')

folder = r'C:\Users\pwalsh\Desktop\Classifier Testing\Datasets\BIO Dataset 4'
for f in os.listdir(folder):
    f = os.path.join(folder, f)
    if os.path.isfile(f):
        os.unlink(f)
os.remove(folder+'.zip')

        
#####################################################################      
# removes all images from symplast subfolders, deletes zipped folders
#####################################################################
folder = r'C:\Users\pwalsh\Desktop\Classifier Testing\Datasets\SYM Dataset 1'
for f in os.listdir(folder):
    f = os.path.join(folder, f)
    if os.path.isfile(f):
        os.unlink(f)
os.remove(folder+'.zip')

folder = r'C:\Users\pwalsh\Desktop\Classifier Testing\Datasets\SYM Dataset 2'
for f in os.listdir(folder):
    f = os.path.join(folder, f)
    if os.path.isfile(f):
        os.unlink(f)
os.remove(folder+'.zip')

folder = r'C:\Users\pwalsh\Desktop\Classifier Testing\Datasets\SYM Dataset 3'
for f in os.listdir(folder):
    f = os.path.join(folder, f)
    if os.path.isfile(f):
        os.unlink(f)
os.remove(folder+'.zip')

folder = r'C:\Users\pwalsh\Desktop\Classifier Testing\Datasets\SYM Dataset 4'
for f in os.listdir(folder):
    f = os.path.join(folder, f)
    if os.path.isfile(f):
        os.unlink(f)
os.remove(folder+'.zip')


#########################################
# removes all images from testing folder
########################################
folder = r'C:\Users\pwalsh\Desktop\Classifier Testing\Testing'
for f in os.listdir(folder):
    f = os.path.join(folder, f)
    if os.path.isfile(f):
        os.unlink(f)
