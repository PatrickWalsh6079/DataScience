'''
Create new image classifier here:
https://console.bluemix.net/catalog/services/visual-recognition
Copy the API key as this parameter will be used for training and testing your model.
'''

# authenticate using IAM token
from watson_developer_cloud import VisualRecognitionV3

visual_recognition = VisualRecognitionV3(
    version='INSERT VERSION DATE HERE',
    iam_apikey='INSERT API KEY HERE'
)

####################
# training the model
####################


import json

# specify the training data to be used
training_folder = r'C:\Users\pwalsh\Desktop\Classifier Testing\Datasets'
training_bio = r'C:\Users\pwalsh\Desktop\Classifier Testing\Datasets\BIO Dataset 1.zip'
training_sym = r'C:\Users\pwalsh\Desktop\Classifier Testing\Datasets\SYM Dataset 1.zip'

from watson_developer_cloud import VisualRecognitionV3

visual_recognition = VisualRecognitionV3(
    'INSERT VERSION DATE HERE',
    iam_apikey='INSERT API KEY HERE')

with open(training_bio, 'rb') as Biofilm, open(
        training_sym, 'rb') as Symplast:
    model = visual_recognition.create_classifier(
        'IBM Model',
        biofilm_positive_examples=Biofilm,
        symplast_positive_examples=Symplast).get_result()
print(json.dumps(model, indent=2))

# retrieve info about classification model

import json
from watson_developer_cloud import VisualRecognitionV3

visual_recognition = VisualRecognitionV3(
    'INSERT VERSION DATE HERE',
    iam_apikey='INSERT API KEY HERE')

classifiers = visual_recognition.list_classifiers(verbose=True).get_result()
print(json.dumps(classifiers, indent=2))

